# RobotBody（Pico2: RP2350）仕様

## 概要
RobotBody（Pico2）は、ロボットのリアルタイム制御・安全監視を担うマイコンです。主に以下の機能を担当します。

## 主な機能

### 1. モーター制御
- 左右モーターの速度・方向制御
- デッドバンド補正、加減速プロファイル（今後拡張予定）
- 安全停止（異常時即時motor.stop()）

### 2. IMU（慣性センサ）処理
- 姿勢・加速度・角速度の周期取得
- キャリブレーション・軸変換
- IMUデータのUARTストリーミング

### 3. 異常運動検知
- 転倒検知（例：ロール/ピッチ閾値超過、加速度急変）
- 持ち上げ検知（例：Z軸加速度低下、静止状態での重力変化）
- 異常検知時は即座にmotor.stop()＋UARTでZero2WへALERT通知

### 4. UART通信
- Zero2WからのASCIIコマンド受信（Rxx, Dyy, S等）
- IMUデータや異常通知の送信
- 通信断時の縮小運転モード切替

### 5. 縮小運転モード
- PC/Zero2Wと通信できない場合の安全動作（例：停止、簡易自律制御）

### 6. 拡張余地
- 歩行プロファイルの高度化
- バッテリー監視、温度監視などの追加センサ対応
- より高度な異常検知・自己診断

## 通信仕様（概要）
- UART（Zero2Wと直結、ASCIIコマンド/IMU CSV/ALERT通知）
- コマンド例：
    - Rxx: 右モーター速度指定
    - Dyy: 左モーター速度指定
    - S: 停止
    - ALERT: 異常発生通知
    - IMU: IMUデータストリーム

## 実装上の注意
- 異常検知・安全停止はPico2内で即時処理し、Zero2Wへも即時通知
- 通信断時は安全側に倒す（縮小運転/停止）
- IMU周期処理は割り込み/タイマで安定動作を確保

---

（本仕様は今後の拡張・実装に応じて随時更新）
